/*! InsightCharts 06-06-2014 */
function Group(a){this._data=a,this._cumulative=!1,this._valueAccessor=function(a){return a},this._orderFunction=function(a,b){return b.value-a.value},this._ordered=!1}function SimpleGroup(a){this._data=a,this._orderFunction=function(a,b){return b.values-a.values}}function NestedGroup(a,b){this._dimension=a,this._data=a.Dimension.bottom(1/0),this._nestFunction=b,this._nestedData=b.entries(this._data)}function Grouping(a){this._cumulative=!1,this.dimension=a;var b=[],c=[],d=[];return this._valueAccessor=function(a){return a},this._orderFunction=function(a,b){return b.value-a.value},this._ordered=!1,this.sum=function(a){return arguments.length?(b=a,this):b},this.count=function(a){return arguments.length?(c=a,this):c},this.average=function(a){return arguments.length?(d=a,b=this.unique(b.concat(d)),this):d},this}function Series(a,b,c,d,e,f){this.chart=b,this.data=c,this.x=d,this.y=e,this.name=a,this.color=d3.functor(f),this.animationDuration=300,d.addSeries(this),e.addSeries(this);var g="",h=function(a){return a},i=function(a){return a.key},j=function(a){return a.value},k=j,l=d3.functor("Label");return this.dataset=function(){var a=this.x.ordered()?this.data.getOrderedData():this.data.getData();return a},this.keys=function(){return this.dataset().map(i)},this.cssClass=function(a){return arguments.length?(g=a,this):g},this.keyAccessor=function(a){return a.key},this.xFunction=function(a){return arguments.length?(i=a,this):i},this.yFunction=function(a){return arguments.length?(j=a,this):j},this.tooltipFunction=function(a){return arguments.length?(k=a,this):k},this.tooltipValue=function(a){return h(k(a))},this.tooltipLabel=function(a){return l(a)},this.tooltipLabelFormat=function(a){return arguments.length?(l=d3.functor(a),this):l},this.tooltipFormat=function(a){return arguments.length?(h=a,this):h},this.matcher=this.keyAccessor,this.findMax=function(a){var b=this,c=0,d=this.data.getData(),e=a==b.x?b.xFunction():b.yFunction(),f=d3.max(d,e);return c=f>c?f:c},this.draw=function(){},this}function Chart(a,b,c){this.name=a,this.element=b,this.dimension=c;var d=d3.functor(300),e=d3.functor(300),f=!1,g=null;this.chart=null,this._margin={top:0,left:0,right:0,bottom:0};var h=[],i=[],j=[],k=this,l=d3.functor(.1);this.addAxis=function(a){j.push(a)},this.addClipPath=function(){this.chart.append("clipPath").attr("id",this.clipPath()).append("rect").attr("x",1).attr("y",0).attr("width",this.width()-this.margin().left-this.margin().right).attr("height",this.height()-this.margin().top-this.margin().bottom)},this.init=function(){this.chart=d3.select(this.element).append("svg").attr("class","chart"),this.chart.attr("width",this.width()).attr("height",this.height()),this.chart=this.chart.append("g").attr("transform","translate("+this.margin().left+","+this.margin().top+")"),this.addClipPath(),i.map(function(a){a.initialize()}),j.map(function(a){a.initialize()}),f&&this.initZoom(),this.tooltip(),this.draw(!1)},this.draw=function(a){this.recalculateScales(),j.map(function(b){b.draw(a)}),this.series().map(function(b){b.draw(a)})},this.recalculateScales=function(){i.map(function(a){var b=g!=a;b&&a.calculateRange()})},this.zoomable=function(a){return f=!0,g=a,this},this.initZoom=function(){this.zoom=d3.behavior.zoom().on("zoom",k.dragging.bind(k)),this.zoom.x(g.scale),this.zoomExists()||this.chart.append("rect").attr("class","zoompane").attr("width",this.width()).attr("height",this.height()-this.margin().top-this.margin().bottom).style("fill","none").style("pointer-events","all"),this.chart.select(".zoompane").call(this.zoom)},this.zoomExists=function(){var a=this.chart.selectAll(".zoompane");return a[0].length},this.dragging=function(){k.draw(!0)},this.barPadding=function(a){return arguments.length?(l=d3.functor(a),this):l()},this.margin=function(a){return arguments.length?(this._margin=a,this):this._margin},this.clipPath=function(){return this.name.split(" ").join("_")+"clip"},this.filterFunction=function(a,b){var c=a.key?a.key:a;return{name:c,element:b,filterFunction:function(a){return String(a)==String(c)}}},this.filterClick=function(a,b){if(this.dimension){var c=this.filterFunction(b,a);this.filterEvent(this.dimension,c)}},this.tooltip=function(){return this.tip=d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(a){return"<span class='tiplabel'>"+a.label+": </span><span class='tipvalue'>"+a.value+"</span>"}),this.chart.call(this.tip),this},this.mouseOver=function(a,b){var c=$(b).find(".tipValue").first().text(),d=$(b).find(".tipLabel").first().text();this.tip.show({label:d,value:c}),d3.select(b).classed("active",!0)},this.mouseOut=function(a,b,c){this.tip.hide(c),d3.select(b).classed("active",!1)},this.width=function(a){return arguments.length?(e=d3.functor(a),this):e()},this.height=function(a){return arguments.length?(d=d3.functor(a),this):d()},this.series=function(a){return arguments.length?void(h=a):h},this.scales=function(a){return arguments.length?void(i=a):i},this.addHorizontalScale=function(a,b,c){new Scale(this,a,c,b)},this.addHorizontalAxis=function(a){new Axis(this,a,"h","left")}}function BubbleSeries(a,b,c,d,e,f){Series.call(this,a,b,c,d,e,f);var g=d3.functor(10),h=d3.functor(f),i=d3.functor(50),j=d3.functor(7),k=this,l=function(a){k.chart.mouseOver(k,this,a),d3.select(this).classed("hover",!0)},m=function(a){k.chart.mouseOut(k,this,a)};this.rangeY=function(a){k.yFunction();return k.y.scale(k.yFunction()(a))},this.rangeX=function(a){k.xFunction();return k.x.scale(k.xFunction()(a))},this.radiusFunction=function(a){return arguments.length?(g=a,this):g},this.fillFunction=function(a){return arguments.length?(h=a,this):h},this.draw=function(a){var b=this.name+InsightConstants.Bubble,c=a?0:function(a,b){return 200+20*b},d=this.dataset(),e=d3.min(d,g),f=d3.max(d,g),n=function(a){return a.radius},o=function(a){return k.chart.filterClick(this,a)};d.forEach(function(a){var b=g(a);a.radius=j()+(b-e)*(i()-j())/(f-e)}),d=d.concat().sort(function(a,b){return d3.descending(n(a),n(b))});var p=this.chart.chart.selectAll("circle."+b).data(d,this.matcher);p.enter().append("circle").attr("class",b+" "+InsightConstants.Bubble).on("mouseover",l).on("mouseout",m).on("click",o),p.transition().duration(c).attr("r",n).attr("cx",k.rangeX).attr("cy",k.rangeY).attr("fill",h),p.append("svg:text").attr("class",InsightConstants.ToolTipTextClass),p.append("svg:text").attr("class",InsightConstants.ToolTipLabelClass),p.selectAll("."+InsightConstants.ToolTipTextClass).text(this.tooltipValue),p.selectAll("."+InsightConstants.ToolTipLabelClass).text(this.tooltipLabel)}}function Scale(a,b,c,d,e){var f=d3.functor(!1),g=this;this.scale=c,this.rangeType=this.scale.rangeRoundBands?this.scale.rangeRoundBands:this.scale.rangeRound,this.series=[],this.title=b,this.chart=a,this.type=e,this.direction=d,this.bounds=[],a.scales().push(this),this.domain=function(){return"linear"==this.type?[0,this.findMax()]:"ordinal"==this.type?this.findOrdinalValues():"time"==this.type?[this.minTime(),this.maxTime()]:void 0},this.calculateBounds=function(){var a=[];return g.horizontal()?(a[0]=0,a[1]=g.chart.width()-g.chart.margin().right-g.chart.margin().left):g.vertical()&&(a[1]=0,a[0]=g.chart.height()-g.chart.margin().top-g.chart.margin().bottom),a},this.minTime=function(){var a=new Date(864e13);return this.series.map(function(b){var c=d3.min(b.keys());a=a>c?c:a}),a},this.maxTime=function(){var a=new Date(-864e13);return this.series.map(function(b){var c=d3.max(b.keys());a=c>a?c:a}),a},this.findOrdinalValues=function(){var a=[];return this.series.map(function(b){a=b.keys()}),a},this.horizontal=function(){return"h"==this.direction},this.vertical=function(){return"v"==this.direction},this.findMax=function(){var a=0;return this.series.map(function(b){var c=b.findMax(g);a=c>a?c:a}),a},this.addSeries=function(a){this.series.push(a)},this.initialize=function(){this.applyScaleRange.call(this.scale.domain(this.domain()),this.rangeType)},this.calculateRange=function(){this.scale.domain(this.domain())},this.applyScaleRange=function(a){var b=g.calculateBounds();g.bounds=b,a.apply(this,[b,g.chart.barPadding()])},this.ordered=function(a){return arguments.length?(f=d3.functor(a),this):f()}}function Axis(a,b,c,d){this.chart=a,this.scale=c,this.anchor=d?d:"left",this.name=b;var e,f=this,g=d3.functor(0),h=d3.functor(10),i=d3.functor("lr"),j=d3.functor(c.horizontal()?this.anchor:this.anchor);c.vertical()&&(e="left"==this.anchor?"end":"start"),c.horizontal()&&(e="start");var k=function(a){return a};this.chart.addAxis(this),this.format=function(a){return arguments.length?(k=a,this):k},this.orientation=function(a){return arguments.length?(j=d3.functor(a),this):j()},this.tickSize=function(a){return arguments.length?(g=d3.functor(a),this):g()},this.tickPadding=function(a){return arguments.length?(h=d3.functor(a),this):h()},this.textAnchor=function(a){return arguments.length?(e=a,this):e},this.labelOrientation=function(a){return arguments.length?(i=d3.functor(a),this):i()},this.tickRotation=function(){var a=f.tickPadding()+2*f.tickSize(),b="tb"==this.labelOrientation()?"rotate(90,0,"+a+")":"";return b},this.transform=function(){var a="translate(";if(f.scale.horizontal())a+="0,"+(f.chart.height()-f.chart.margin().bottom-f.chart.margin().top)+")";else if(f.scale.vertical()){var b="left"==f.anchor?0:f.chart.width()-f.chart.margin().right-f.chart.margin().left;a+=b+",0)"}return a},this.labelHorizontalPosition=function(){var a="";return f.scale.horizontal()||f.scale.vertical(),a},this.labelVerticalPosition=function(){var a="";return f.scale.horizontal()||f.scale.vertical(),a},this.positionLabels=function(a){f.scale.horizontal()?a.style("left",0).style("bottom",0).style("width","100%").style("text-align","center"):f.scale.vertical()&&a.style("left","0").style("top","35%")},this.initialize=function(){this.axis=d3.svg.axis().scale(this.scale.scale).orient(f.orientation()).tickSize(f.tickSize()).tickPadding(f.tickPadding()).tickFormat(f.format()),this.chart.chart.append("g").attr("class",f.name+" "+InsightConstants.AxisClass).attr("transform",f.transform()).call(this.axis).selectAll("text").attr("class",f.name+" "+InsightConstants.AxisTextClass).style("text-anchor",f.textAnchor()).style("transform",f.tickRotation());var a=d3.select(this.chart.element).append("div").attr("class",f.name+InsightConstants.AxisLabelClass).style("position","absolute").text(f.scale.title);this.positionLabels(a)},this.draw=function(){this.axis=d3.svg.axis().scale(this.scale.scale).orient(f.orientation()).tickSize(f.tickSize()).tickPadding(f.tickPadding()).tickFormat(f.format());var a=this.chart.chart.selectAll("g."+f.name+"."+InsightConstants.AxisClass).call(this.axis);a.selectAll("text").attr("transform",f.tickRotation()).style("text-anchor",f.textAnchor()),d3.select(this.chart.element).select("div."+f.name+InsightConstants.AxisLabelClass).text(f.scale.title)}}function LineSeries(a,b,c,d,e,f){Series.call(this,a,b,c,d,e,f);var g=this,h="linear",i=function(a){g.chart.mouseOver(g,this,a),d3.select(this).classed("hover",!0)},j=function(a){g.chart.mouseOut(g,this,a)},k=function(){},l=function(){},m=function(){};this.rangeY=function(a){return g.y.scale(g.yFunction()(a))},this.rangeX=function(a){var b=0;return b=g.x.scale.rangeBand?g.x.scale(g.xFunction()(a))+g.x.scale.rangeBand()/2:g.x.scale(g.xFunction()(a))},this.lineType=function(a){return arguments.length?(h=a,this):h},this.draw=function(a){var b=d3.svg.line().x(g.rangeX).y(g.rangeY).interpolate(h),c="path."+this.name+".in-line",d=this.chart.chart.selectAll(c);this.rangeExists(d)||this.chart.chart.append("path").attr("class",this.name+" in-line").attr("stroke",this.color).attr("fill","none").attr("clip-path","url(#"+this.chart.clipPath()+")").on("mouseover",k).on("mouseout",l).on("click",m);var e=a?0:300;this.chart.chart.selectAll(c).datum(this.dataset(),this.matcher).transition().duration(e).attr("d",b);var f=this.chart.chart.selectAll("circle").data(this.dataset());f.enter().append("circle").attr("class","target-point").attr("clip-path","url(#"+this.chart.clipPath()+")").attr("cx",g.rangeX).attr("cy",g.chart.height()-g.chart.margin().bottom-g.chart.margin().top).on("mouseover",i).on("mouseout",j),f.transition().duration(e).attr("cx",g.rangeX).attr("cy",g.rangeY).attr("r",2.5),f.append("svg:text").attr("class",InsightConstants.ToolTipTextClass),f.append("svg:text").attr("class",InsightConstants.ToolTipLabelClass),f.selectAll("."+InsightConstants.ToolTipTextClass).text(this.tooltipValue),f.selectAll("."+InsightConstants.ToolTipLabelClass).text(this.tooltipLabel)},this.rangeExists=function(a){return a[0].length}}function ColumnSeries(a,b,c,d,e,f){Series.call(this,a,b,c,d,e,f);var g=this,h=d3.functor(!1),i=(this.x.rangeType,function(a){g.chart.mouseOver(g,this,a)}),j=function(a){g.chart.mouseOut(g,this,a)};this.findMax=function(){var a=0;for(var b in this.series){var c=this.series[b],d=this.data.getData(),e=d3.max(d,c.accessor);a=e>a?e:a}return a},this.series=[{name:"default",accessor:function(a){return a.value},tooltipValue:function(a){return a.value},color:d3.functor("silver"),label:"Value"}],this.stacked=function(a){return arguments.length?(h=d3.functor(a),this):h()},this.calculateYPos=function(a,b){return b.yPos||(b.yPos=0),b.yPos+=a(b),b.yPos},this.xPosition=function(a){return g.x.scale(g.xFunction()(a))},this.calculateXPos=function(a,b){return b.xPos?b.xPos+=a:b.xPos=g.xPosition(b),b.xPos},this.yPosition=function(a){var b=g.y.scale(g.stackedBars()?g.calculateYPos(g.yFunction(),a):g.yFunction()(a));return b},this.barWidth=function(a){return g.x.scale.rangeBand(a)},this.groupedBarWidth=function(a){var b=g.barWidth(a),c=g.stackedBars()||1==g.series.length?b:b/g.series.length;return c},this.offsetXPosition=function(a){var b=g.groupedBarWidth(a),c=g.stackedBars()?g.xPosition(a):g.calculateXPos(b,a);return c},this.barHeight=function(a){return g.chart.height()-g.chart.margin().top-g.chart.margin().bottom-g.y.scale(g.yFunction()(a))},this.stackedBars=function(){return g.stacked()},this.draw=function(a){var b=function(a){a.yPos=0,a.xPos=0},c=this.chart.chart.selectAll("g."+InsightConstants.BarGroupClass).data(this.dataset(),this.matcher).each(b),d=c.enter().append("g").attr("class",InsightConstants.BarGroupClass),e=d.selectAll("rect.bar"),f=function(a){return g.chart.filterClick(this,a)};for(var h in this.series){var k=this.series[h];this.yFunction(k.accessor),e=d.append("rect").attr("class",k.name+"class bar").attr("y",this.y.bounds[0]).attr("height",0).attr("fill",k.color).attr("clip-path","url(#"+this.chart.clipPath()+")").on("mouseover",i).on("mouseout",j).on("click",f),e.append("svg:text").attr("class",InsightConstants.ToolTipTextClass),e.append("svg:text").attr("class",InsightConstants.ToolTipLabelClass);var l=a?0:300,m=c.selectAll("."+k.name+"class.bar").transition().duration(l).attr("y",this.yPosition).attr("x",this.offsetXPosition).attr("width",this.groupedBarWidth).attr("height",this.barHeight);m.selectAll("."+InsightConstants.ToolTipTextClass).text(k.tooltipValue),m.selectAll("."+InsightConstants.ToolTipLabelClass).text(k.label)}}}function ColumnChart(a,b,c,d){BaseChart.call(this,a,b,c,d);var e=this,f=function(a){e.mouseOver(e,this,a)},g=function(a){e.mouseOut(e,this,a)};this.calculateYPos=function(a,b){return b.yPos||(b.yPos=0),b.yPos+=a(b),b.yPos},this.calculateXPos=function(a,b){return b.xPos?b.xPos+=a:b.xPos=e.xPosition(b),b.xPos},this.yPosition=function(a){var b=e.y(e.stackedBars()?e.calculateYPos(e._valueAccessor,a):e._valueAccessor(a));return b},this.groupedBarWidth=function(a){var b=e.barWidth(a),c=e.stackedBars()||1==e.series().length?b:b/e.series().length;return c},this.offsetXPosition=function(a){var b=e.groupedBarWidth(a),c=e.stackedBars()?e.xPosition(a):e.calculateXPos(b,a);return c},this.stackedBars=function(){return e.stacked()||1==this.series().length},this.init=function(){var a=this;this.createChart(),this.initializeAxes(),this.yAxis=d3.svg.axis().scale(this.y).orient(a.yOrientation()).tickSize(a.tickSize()).tickPadding(a.tickPadding()).tickFormat(a.yAxisFormat()),this.xAxis=d3.svg.axis().scale(this.x).orient(a.xOrientation()).tickSize(a.tickSize()).tickPadding(a.tickPadding()).tickFormat(a.xAxisFormat()),this.addClipPath(),this.zoomable()&&this.initZoom(),this.drawAxes(),this.draw()},this.draw=function(a){var b=this;a&&b.redrawAxes()&&this.y.domain([0,d3.round(b.findMax(),1)]).range([this.height()-this.margin().top-this.margin().bottom,0]),this.drawRanges(InsightConstants.Behind),this.drawBars(a),this.drawRanges(InsightConstants.Front),this.drawTargets(a),this.updateAxes()},this.drawAxes=function(){this.chart.append("g").attr("class",InsightConstants.YAxisClass).call(this.yAxis).selectAll("text").attr("class",InsightConstants.AxisTextClass),this.chart.append("g").attr("class",InsightConstants.XAxisClass).attr("transform","translate(0,"+(e.height()-e.margin().bottom-e.margin().top)+")").call(this.xAxis).selectAll("text").attr("class",InsightConstants.AxisTextClass).style("text-anchor","start").style("writing-mode","tb").on("mouseover",this.setHover).on("mouseout",this.removeHover).on("click",function(a){return e.filterClick(this,a)})},this.drawRanges=function(a){var b=a?this.ranges().filter(function(b){return b.position==a}):this.ranges();if(b)for(var c in b){this._rangeAccessor=b[c].calculation;var d=b[c].type(this),e="path."+b[c].class,f=this.chart.selectAll(e);this.rangeExists(f)||this.chart.append("path").attr("class",b[c].class).attr("fill",b[c].color),this.chart.selectAll(e).datum(this.dataset(),this.matcher).transition().duration(this.animationDuration).attr("d",d)}},this.rangeExists=function(a){return a[0].length},this.drawBars=function(a){var b=function(a){a.yPos=0,a.xPos=0},c=this.chart.selectAll("g."+InsightConstants.BarGroupClass).data(this.dataset(),this.matcher).each(b),d=c.enter().append("g").attr("class",InsightConstants.BarGroupClass),e=d.selectAll("rect.bar");for(var h in this.series()){this._valueAccessor=this.cumulative()?this.series()[h].cumulative:this.series()[h].calculation,e=d.append("rect").attr("class",this.series()[h].name+"class bar").attr("y",this.yDomain()).attr("height",0).attr("fill",this.series()[h].color).attr("clip-path","url(#clip)").on("mouseover",f).on("mouseout",g),e.append("svg:text").attr("class",InsightConstants.ToolTipTextClass),e.append("svg:text").attr("class",InsightConstants.ToolTipLabelClass);var i=a?0:this.animationDuration,j=c.selectAll("."+this.series()[h].name+"class.bar").transition().duration(i).attr("y",this.yPosition).attr("x",this.offsetXPosition).attr("width",this.groupedBarWidth).attr("height",this.barHeight);j.selectAll("."+InsightConstants.ToolTipTextClass).text(this.tooltipText),j.selectAll("."+InsightConstants.ToolTipLabelClass).text(this.series()[h].label)}},this.updateAxes=function(){var a=this.chart.selectAll("g."+InsightConstants.XAxisClass).call(this.xAxis);a.selectAll("text").style("text-anchor","start").style("writing-mode","tb").on("mouseover",this.setHover).on("mouseout",this.removeHover).on("click",function(a){return e.filterClick(this,a)}),a.selectAll("text:not(.selected)").attr("class",InsightConstants.XAxisClass+" "+InsightConstants.AxisTextClass),this.chart.selectAll("."+InsightConstants.YAxisClass).call(this.yAxis).selectAll("text").attr("class",InsightConstants.AxisTextClass)},this.drawTargets=function(){if(this.targets()){this._targetAccessor=_targets.calculation;var a=this.chart.selectAll("rect.target").data(this.targetData(),this.matcher),b=a.enter().append("rect").attr("class","target "+_targets.name+"class").on("mouseover",function(){e.mouseOver(e,this)}).on("mouseout",function(){e.mouseOut(e,this)});b.append("svg:text").text(this.targetTooltipText).attr("class",InsightConstants.ToolTipTextClass),b.append("svg:text").text(_targets.label).attr("class",InsightConstants.ToolTipLabelClass),a.transition().duration(this.animationDuration).attr("x",this.targetX).attr("y",this.targetY).attr("width",this.targetWidth).attr("height",4).attr("fill",_targets.color),a.selectAll("."+InsightConstants.ToolTipTextClass).text(this.targetTooltipText).attr("class",InsightConstants.ToolTipTextClass)}}}function PartitionChart(a,b,c,d){this.element=b,this.group=d;var e=1120,f=600,g=d3.scale.linear().range([0,e]),h=d3.scale.linear().range([0,f]);this.vis=d3.select(this.element).append("div").attr("class","chart").style("width",e+"px").style("height",f+"px").append("svg:svg").attr("width",e).attr("height",f),this.partition=d3.layout.partition().children(function(a){return a.values}).value(function(a){return a.ProjectedRevenue}),this.init=function(){function a(a){return"translate(8,"+a.dx*j/2+")"}function b(b){if(b.children){i=(b.y?e-40:e)/(1-b.y),j=f/b.dx,g.domain([b.y,1]).range([b.y?40:0,e]),h.domain([b.x,b.x+b.dx]);var c=d.transition().duration(d3.event.altKey?7500:750).attr("transform",function(a){return"translate("+g(a.y)+","+h(a.x)+")"});c.select("rect").attr("width",b.dy*i).attr("height",function(a){return a.dx*j}),c.select("text").attr("transform",a).style("opacity",function(a){return a.dx*j>12?1:0}),d3.event.stopPropagation()}}var c=this,d=this.vis.selectAll("g").data(c.partition.nodes(this.group())).enter().append("svg:g").attr("transform",function(a){return"translate("+g(a.y)+","+h(a.x)+")"}).on("click",b),i=e/this.group().dx,j=f/1;d.append("svg:rect").attr("width",this.group().dy*i).attr("height",function(a){return a.dx*j}).attr("class",function(a){return a.children?"parent":"child"}).attr("fill","rgb(135, 158, 192)").style("stroke","#fff"),d.append("svg:text").attr("transform",a).attr("dy",".35em").attr("dx","2em").attr("fill","#ecf0f1").style("font-size","13px").style("opacity",function(a){return a.dx*j>12?1:0}).text(function(a){return a.key})}}Group.prototype.filterFunction=function(a){return arguments.length?(this._filterFunction=a,this):this._filterFunction},Group.prototype.cumulative=function(a){return arguments.length?(this._cumulative=a,this):this._cumulative},Group.prototype.getData=function(){var a;return a=this._data.all?this._data.all():this._data,this._filterFunction&&(a=a.filter(this._filterFunction)),a},Group.prototype.getOrderedData=function(){var a;return a=this._data.all?a=this._data.top(1/0).sort(this.orderFunction()):this._data.sort(this.orderFunction()),this._filterFunction&&(a=a.filter(this._filterFunction)),a},Group.prototype.computeFunction=function(a){return this._ordered=!0,arguments.length?(this._compute=a,this):this._compute},Group.prototype.orderFunction=function(a){return arguments.length?(this._orderFunction=a,this):this._orderFunction},Group.prototype.compute=function(){this._compute()},Group.prototype.valueAccessor=function(a){return arguments.length?(this._valueAccessor=a,this):this._valueAccessor},Group.prototype.calculateTotals=function(){if(this._cumulative){var a={},b=0,c=this,d=this._ordered?this.getOrderedData():this.getData();d.forEach(function(d){var e=c._valueAccessor(d);if("object"!=typeof e)b+=e,d.Cumulative=b;else for(var f in e){var g=f+"Cumulative";a[g]?(a[g]+=e[f],e[g]=a[g]):(a[g]=e[f],e[g]=a[g])}})}return this},SimpleGroup.prototype=Object.create(Group.prototype),SimpleGroup.prototype.constructor=SimpleGroup,SimpleGroup.prototype.getOrderedData=function(){return this._data.sort(this._orderFunction)},SimpleGroup.prototype.getData=function(){return this._data},NestedGroup.prototype=Object.create(Group.prototype),NestedGroup.prototype.constructor=NestedGroup,NestedGroup.prototype.getData=function(){return this._nestedData},NestedGroup.prototype.updateNestedData=function(){this._data=this._dimension.Dimension.bottom(1/0),this._nestedData=this._nestFunction.entries(this._data)},NestedGroup.prototype.getOrderedData=function(){return this._nestedData},Grouping.prototype.filterFunction=function(a){return arguments.length?(this._filterFunction=a,this):this._filterFunction},Grouping.prototype.cumulative=function(a){return arguments.length?(this._cumulative=a,this):this._cumulative},Grouping.prototype.unique=function(a){for(var b=a.concat(),c=0;c<b.length;++c)for(var d=c+1;d<b.length;++d)b[c]===b[d]&&b.splice(d--,1);return b},Grouping.prototype.initialize=function(){var a=this.sum(),b=this.count(),c=this.average(),d=this.dimension.Dimension.group().reduce(function(d,e){d.Count++;for(var f in a)e.hasOwnProperty(a[f])&&(d[a[f]].Sum+=e[a[f]]);for(var g in c)e.hasOwnProperty(c[g])&&(d[c[g]].Average=d[c[g]].Average+(e[c[g]]-d[c[g]].Average)/d.Count);for(var h in b)e.hasOwnProperty(b[h])&&(d[b[h]][e[b[h]]]=d[b[h]].hasOwnProperty(e[b[h]])?d[b[h]][e[b[h]]]+1:1,d[b[h]].Total++);return d},function(d,e){d.Count--;for(var f in a)e.hasOwnProperty(a[f])&&(d[a[f]].Sum-=e[a[f]]);for(var g in b)e.hasOwnProperty(b[g])&&(d[b[g]][e[b[g]]]=d[b[g]].hasOwnProperty(e[b[g]])?d[b[g]][e[b[g]]]-1:1,d[b[g]].Total--);for(var h in c)if(e.hasOwnProperty(c[h])){var i=(e[c[h]],d[c[h]].Sum);d[c[h]].Average=i/d.Count;var j=d[c[h]].Average;isFinite(j)||(d[c[h]].Average=0)}return d},function(){var d={Count:0};for(var e in a)d[a[e]]=d[a[e]]?d[a[e]]:{},d[a[e]].Sum=0;for(var f in c)d[c[f]]=d[c[f]]?d[c[f]]:{},d[c[f]].Average=0;for(var g in b)d[b[g]]=d[b[g]]?d[b[g]]:{},d[b[g]].Total=0;return d});return this._data=d,this},Grouping.prototype.getData=function(){var a;return a=this._data.all?this._data.all():this._data,this._filterFunction&&(a=a.filter(this._filterFunction)),a},Grouping.prototype.getOrderedData=function(){var a;return a=this._data.all?a=this._data.top(1/0).sort(this.orderFunction()):this._data.sort(this.orderFunction()),this._filterFunction&&(a=a.filter(this._filterFunction)),a},Grouping.prototype.computeFunction=function(a){return this._ordered=!0,arguments.length?(this._compute=a,this):this._compute},Grouping.prototype.orderFunction=function(a){return arguments.length?(this._orderFunction=a,this):this._orderFunction},Grouping.prototype.compute=function(){this._compute()},Grouping.prototype.valueAccessor=function(a){return arguments.length?(this._valueAccessor=a,this):this._valueAccessor},Grouping.prototype.calculateTotals=function(){if(this._cumulative){var a={},b=0,c=this,d=this._ordered?this.getOrderedData():this.getData();d.forEach(function(d){var e=c._valueAccessor(d);if("object"!=typeof e)b+=e,d.Cumulative=b;else for(var f in e){var g=f+"Cumulative";a[g]?(a[g]+=e[f],e[g]=a[g]):(a[g]=e[f],e[g]=a[g])}})}return this};var Dimension=function(a,b,c,d){this.Dimension=c,this.Name=a,this.Filters=[],this.Function=b,this.displayFunction=d?d:function(a){return a},this.comparer=function(a){return a.Name==this.Name}.bind(this)},InsightFormatters=function(a){var b={};return b.moduleProperty=1,b.currencyFormatter=function(b){var c=a.format(",f");return"Â£"+c(b)},b.dateFormatter=function(b){var c=a.time.format("%b %Y");return c(b)},b.percentageFormatter=function(b){var c=a.format("%");return c(b)},b}(d3),InsightConstants=function(){var a={};return a.Behind="behind",a.Front="front",a.AxisTextClass="axis-text",a.AxisLabelClass="axis-label",a.YAxisClass="y-axis",a.AxisClass="in-axis",a.XAxisClass="x-axis",a.XAxisRotation="rotate(90)",a.ToolTipTextClass="tipValue",a.ToolTipLabelClass="tipLabel",a.BarGroupClass="bargroup",a.Bubble="bubble",a}();BubbleSeries.prototype=Object.create(Series.prototype),BubbleSeries.prototype.constructor=BubbleSeries,LineSeries.prototype=Object.create(Series.prototype),LineSeries.prototype.constructor=LineSeries,ColumnSeries.prototype=Object.create(Series.prototype),ColumnSeries.prototype.constructor=ColumnSeries;var ChartGroup=function(a){this.Name=a,this.Charts=[],this.Dimensions=[],this.FilteredDimensions=[],this.Groups=[],this.CumulativeGroups=[],this.ComputedGroups=[],this.LinkedCharts=[],this.NestedGroups=[]};ChartGroup.prototype.initCharts=function(){this.Charts.forEach(function(a){a.init()})},ChartGroup.prototype.addChart=function(a){return a.filterEvent=this.chartFilterHandler.bind(this),a.triggerRedraw=this.redrawCharts.bind(this),this.Charts.push(a),a},ChartGroup.prototype.addDimension=function(a,b,c,d){var e=new Dimension(b,c,a.dimension(c),d);return this.Dimensions.push(e),e},ChartGroup.prototype.compareFilters=function(a){return function(b){return String(b.name)==String(a.name)}},ChartGroup.prototype.chartFilterHandler=function(a,b){var c=this;if(b){var d=this.Dimensions.filter(a.comparer),e=this.FilteredDimensions.filter(a.comparer);e.length||this.FilteredDimensions.push(a);var f=this.compareFilters(b);d.map(function(a){var d=a.Filters.filter(f).length;d?c.removeMatchesFromArray(a.Filters,f):a.Filters.push(b),0===a.Filters.length?(c.removeItemFromArray(c.FilteredDimensions,a),a.Dimension.filterAll()):a.Dimension.filter(function(b){var c=a.Filters.map(function(a){return a.filterFunction(b)});return c.filter(function(a){return a}).length})}),this.NestedGroups.forEach(function(a){a.updateNestedData()}),this.ComputedGroups.forEach(function(a){a.compute()}),this.CumulativeGroups.forEach(function(a){a.calculateTotals()}),this.redrawCharts()}},ChartGroup.prototype.redrawCharts=function(){for(var a=0;a<this.Charts.length;a++)this.Charts[a].draw()},ChartGroup.prototype.aggregate=function(a,b){var c;if(b instanceof Array)c=this.multiReduceSum(a,b),this.Groups.push(c);else{var d=a.Dimension.group().reduceSum(b);c=new Group(d),this.Groups.push(c)}return c},ChartGroup.prototype.count=function(a,b){var c;if(b instanceof Array)c=this.multiReduceCount(a,b),this.Groups.push(c);else{var d=a.Dimension.group().reduceCount(b);c=new Group(d),this.Groups.push(c)}return c},ChartGroup.prototype.addSumGrouping=function(a,b){var c=a.Dimension.group().reduceSum(b),d=new Group(c);return this.Groups.push(d),d},ChartGroup.prototype.addCustomGrouping=function(a){return this.Groups.push(a),a.cumulative()&&this.CumulativeGroups.push(a),a},ChartGroup.prototype.multiReduceSum=function(a,b){var c=a.Dimension.group().reduce(function(a,c){for(var d in b)c.hasOwnProperty(b[d])&&(a[b[d]]+=c[b[d]]);return a},function(a,c){for(var d in b)c.hasOwnProperty(b[d])&&(a[b[d]]-=c[b[d]]);return a},function(){var a={};for(var c in b)a[b[c]]=0;return a}),d=new Group(c);return d},ChartGroup.prototype.multiReduceCount=function(a,b){var c=a.Dimension.group().reduce(function(a,c){for(var d in b)c.hasOwnProperty(b[d])&&(a[b[d]][c[b[d]]]=a[b[d]].hasOwnProperty(c[b[d]])?a[b[d]][c[b[d]]]+1:1,a[b[d]].Total++);return a},function(a,c){for(var d in b)c.hasOwnProperty(b[d])&&(a[b[d]][c[b[d]]]=a[b[d]].hasOwnProperty(c[b[d]])?a[b[d]][c[b[d]]]-1:1,a[b[d]].Total--);return a},function(){var a={};for(var c in b)a[b[c]]={Total:0};return a}),d=new Group(c);return this.Groups.push(d),d},ChartGroup.prototype.removeMatchesFromArray=function(a,b){var c=this,d=a.filter(b);d.forEach(function(b){c.removeItemFromArray(a,b)})},ChartGroup.prototype.removeItemFromArray=function(a,b){var c=a.indexOf(b);c>-1&&a.splice(c,1)};var BaseChart=function(a,b,c,d){var e=this;this.element=b,this.dimension=c,this.group=d,this._name=a;var f=d3.functor(a);this.x=d3.scale.ordinal(),this.y=d3.scale.linear(),this._keyAccessor=function(a){return a.key},this._valueAccessor=function(a){return a.value};var g=d3.functor(300),h=d3.functor(300),i=d3.functor(!1),j=d3.functor(!1),k=d3.functor(!1),l=d3.functor(.2),m=d3.functor(20),n=d3.functor("11px"),o=d3.functor(!1),p=d3.functor(!1),q=d3.functor("blue"),r=d3.functor(!1),s=d3.functor(0),t=d3.functor(10),u=d3.functor("left"),v=d3.functor("bottom"),w=d3.functor("Value"),x=function(a){return a},y=function(a){return a};this._currentMax=0,this.isFiltered=!1,this.duration=400,this.filters=[],this._linkedCharts=[],this._xRangeType=this.x.rangeRoundBands,this._yRangeType=this.y.range,this._barWidthFunction=this.x.rangeBand,this._margin={top:0,bottom:0,left:0,right:0},this._defaultSeries={name:"default",label:function(){return e.tooltipLabel()},calculation:e._valueAccessor,color:function(a){return q(a)}};var z=[this._defaultSeries],A=null,B=[];this._targetAccessor=function(a){return a.value},this.matcher=function(a){return e._keyAccessor(a)},this._rangeAccessor=function(a){return a.value},this._limitFunction=function(){return!0},this._labelAccessor=function(a){return a.key},this._tooltipFormat=function(a){return a
},this.xPosition=function(a){var b=Math.round(e._barWidthFunction==e.x.rangeBand||e._barWidthFunction==e.x.rangeRound?0:e.barWidth(a)/2);return e.x(e._keyAccessor(a))-b},this.yPosition=function(a){return e.y(e._valueAccessor(a))},this.rangeY=function(a){return e.y(e._rangeAccessor(a))},this.animationDuration=function(a,b){return e.duration+b},this.rangeX=function(a,b){var c=b==e.keys().length-1?e._barWidthFunction(a):0;return e.x(e._keyAccessor(a))+c},this.barHeight=function(a){return e.height()-e.margin().top-e.margin().bottom-e.y(e._valueAccessor(a))},this.targetY=function(a){return e.y(e._targetAccessor(a))},this.targetX=function(a){var b=e._barWidthFunction==e.x.rangeBand?0:e.barWidth(a)/2;return e.x(e._keyAccessor(a))+e._barWidthFunction(a)/3-b},this.targetWidth=function(a){return e._barWidthFunction(a)/3},this.targetTooltipText=function(a){return e._tooltipFormat(e._targetAccessor(a))},this.tooltipText=function(a){return e._tooltipFormat(e._valueAccessor(a))},this.yDomain=function(){return e.height()-e.margin().top-e.margin().bottom},this.xDomain=function(){return e.width()-e.margin().left-e.margin().right},this.xBounds=function(){var a=this.invert()?this.margin().right:this.margin().left,b=this.width()-(this.margin().right+this.margin().left);return{start:a,end:b}},this.yBounds=function(){var a=this.invert()?this.margin().top:this.margin().bottom,b=this.height()-(this.margin().top+this.margin().bottom);return{start:a,end:b}},this.createChart=function(a){return a||d3.select(this.element).append("div").attr("class","title").text(this._displayName),this.chart=d3.select(this.element).append("svg").attr("class","chart"),this.chart.attr("width",this.width()).attr("height",this.height()),this.chart=this.chart.append("g").attr("transform","translate("+this.margin().left+","+this.margin().top+")"),this.applyOrderableHeader(),this.tooltip(),this.chart},this.calculateBarColor=function(a){return q(a)},this.zoomable=function(a){return arguments.length?(this._zoomable=a,this):this._zoomable},this.displayName=function(a){return arguments.length?(f=d3.functor(a),this):f()},this.yOrientation=function(a){return arguments.length?(u=d3.functor(a),this):u()},this.xOrientation=function(a){return arguments.length?(v=d3.functor(a),this):v()},this.tickSize=function(a){return arguments.length?(s=d3.functor(a),this):s()},this.tickPadding=function(a){return arguments.length?(t=d3.functor(a),this):t()},this.width=function(a){return arguments.length?(h=d3.functor(a),this):h()},this.height=function(a){return arguments.length?(g=d3.functor(a),this):g()},this.orderable=function(a){return arguments.length?(p=d3.functor(a),this):p()},this.ordered=function(a){return arguments.length?(o=d3.functor(a),this):o()},this.orderChildren=function(a){return arguments.length?(this._orderChildren=a,this):this._orderChildren},this.initZoom=function(){this.zoom=d3.behavior.zoom().on("zoom",this.dragging.bind(this)),this.zoom.x(this.x),this.chart.append("rect").attr("class","pane").attr("width",this.width()).attr("height",this.yDomain()).on("click",e.clickEvent).style("fill","none").style("pointer-events","all").call(this.zoom)},this.addClipPath=function(){this.chart.append("clipPath").attr("id","clip").append("rect").attr("x",1).attr("y",0).attr("width",this.width()).attr("height",this.yDomain())},this.dragging=function(){this.draw(!0)},this.setXAxisRange=function(a){return this._xRangeType=a(this.x),this},this.initializeAxes=function(){this.initializeXAxis(this),this.initializeYAxis(this)},this.xDomainRange=function(){return this.keys()},this.xRange=function(a){return arguments.length?(this.xDomainRange=a,this):this.xDomainRange()},this.initializeYAxis=function(a){this.applyYAxisRange.call(a.y.domain([0,a.findMax()]),a,a._yRangeType)},this.initializeXAxis=function(a){this.applyXAxisRange.call(a.x.domain(a.xDomainRange()),a,a._xRangeType)},this.applyXAxisRange=function(a,b){b.apply(this,[[0,a.xDomain()],a.barPadding()])},this.applyYAxisRange=function(a,b){b.apply(this,[[a.yDomain(),0],0])},this.link=function(a,b){return-1==this._linkedCharts.indexOf(a)&&(this._linkedCharts.push(a),b&&this._linkedCharts.forEach(function(b){b.link(a,!1)})),this},this.cumulative=function(a){return arguments.length?(j=d3.functor(a),this):j()},this.xAxisFormat=function(a){return arguments.length?(y=a,this):y},this.updateMax=function(a){var b,c=0;for(var d in this.series())b=this.cumulative()?this.series()[d].cumulative:this.series()[d].calculation,c+=b(a),this._currentMax=c>this._currentMax?c:this._currentMax;if(this.ranges().length)for(var e in this.ranges())b=this.ranges()[e].calculation,c=b(a),this._currentMax=c>this._currentMax?c:this._currentMax;return this._currentMax},this.targetMax=function(a){var b=0;return A&&(func=this.cumulative()?A.cumulative:A.calculation,b=func(a),this._currentMax=b>this._currentMax?b:this._currentMax),this._currentMax},this.findMax=function(){var a=this,b=d3.max(this.dataset(),function(b){return a.updateMax(b)});if(A){var c=d3.max(A.data.getData(),function(b){return a.targetMax(b)});b=b>c?b:c}return this.maxUpdatedEvent(b),b},this.zeroValueEntry=function(a){var b,c=0;if(this.series().length)for(var d in this.series())b=this.cumulative()?this.series()[d].cumulative:this.series()[d].calculation,c|=Math.round(b(a),1)>0;else c|=Math.round(this._valueAccessor(a),1)>0;return A&&(b=this.cumulative()?A.cumulative:A.calculation,c|=Math.round(b(a),1)>0),c},this.keys=function(){var a=this,b=[];return b=this.redrawAxes()?this.dataset().filter(function(b){return a.zeroValueEntry(b)}).map(this._keyAccessor):this.dataset().map(this._keyAccessor)},this.series=function(a){return arguments.length?(z=a,this):z},this.stacked=function(a){return arguments.length?(i=d3.functor(a),this):i()},this.targets=function(a){return arguments.length?(A=a,this):A},this.ranges=function(a){return arguments.length?(B=a,this):B},this.toggleSortIcon=function(){var a=this;a.ordered()?d3.select(a.element).select(".fa-arrow-up").style("display","inline-block"):d3.select(a.element).select(".fa-arrow-up").style("display","none")},this.titleClicked=function(){this.ordered(!this.ordered()),this.toggleSortIcon.call(this),this.draw()},this.applyOrderableHeader=function(){if(this.orderable()){var a=this.ordered()?"inline-block":"none";d3.select(this.element).select("div.title").style("cursor","pointer").on("click",this.titleClicked.bind(this)).append("div").attr("class","order-icon fa fa-arrow-up").style("display",a)}},this.topResults=function(a){return arguments.length?(this._topResults=a,this):this._topResults},this.dataset=function(){var a=this.ordered()?this.group.getOrderedData():this.group.getData();return a.filter(this._limitFunction)},this.targetData=function(){return A.data.getData().filter(this._limitFunction)},this.keyAccessor=function(a){return arguments.length?(this._keyAccessor=a,this):this._keyAccessor},this.labelAccessor=function(a){return arguments.length?(this._labelAccessor=a,this):this._labelAccessor},this.tooltipFormat=function(a){return arguments.length?(this._tooltipFormat=a,this):this._tooltipFormat},this.barPadding=function(a){return arguments.length?(l=d3.functor(a),this):l()},this.yAxisFormat=function(a){return arguments.length?(x=a,this):x},this.valueAccessor=function(a){return arguments.length?(this._valueAccessor=a,this._defaultSeries.calculation=a,this):this._valueAccessor},this.redrawAxes=function(a){return arguments.length?(k=d3.functor(a),this):k()},this.margin=function(a){return arguments.length?(this._margin=a,this):this._margin},this.setXAxis=function(a){return arguments.length?(this.x=a,this):this.x},this.invert=function(a){return arguments.length?(r=d3.functor(a),this):r()},this.setHover=function(){d3.select(this).classed("active",!0)},this.removeHover=function(){d3.select(this).classed("active",!1)},this.mouseOver=function(a,b){if(a.hasTooltip){var c=$(b).find(".tipValue").first().text(),d=$(b).find(".tipLabel").first().text();a.tip.show({label:d,value:c})}d3.select(b).classed("active",!0)},this.mouseOut=function(a,b,c){a.hasTooltip&&a.tip.hide(c),d3.select(b).classed("active",!1)},this.isFunction=function(a){var b={};return a&&"[object Function]"===b.toString.call(a)},this.labelColor=function(a){return arguments.length?(this._labelColor=a,this):this._labelColor},this.barColor=function(a){return arguments.length?(q=d3.functor(a),this):q()},this.tooltipLabel=function(a){return arguments.length?(w=d3.functor(a),this):w()},this.tooltip=function(){return this.hasTooltip=!0,this.tip=d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(a){return"<span class='tiplabel'>"+a.label+": </span><span class='tipvalue'>"+a.value+"</span>"}),this.chart.call(this.tip),this},this.filterKey=function(){},this.limit=function(a){return arguments.length?(this._limitFunction=a,this):this._limitFunction},this.labelPadding=function(a){return arguments.length?(m=d3.functor(a),this):m()},this.labelFontSize=function(a){return arguments.length?(n=d3.functor(a),this):n()},this.labelAnchoring=function(){return this.invert()?"end":"start"},this.filterFunction=function(a,b){var c=a.key?a.key:a;return{name:c,element:b,filterFunction:function(a){return String(a)==String(c)}}},this.draw=function(){},this.init=function(){},this.triggerRedraw=function(){},this.filterEvent=function(){},this.updateTargets=function(){},this.drawTargets=function(){},this.maxUpdatedEvent=function(a){this._linkedCharts.forEach(function(b){b._currentMax=b._currentMax<a?a:b._currentMax})},this.filterClick=function(a,b){if(this.dimension){var c=this.filterFunction(b,a);this.filterEvent(this.dimension,c)}},this.barWidth=function(a){return e._barWidthFunction(a)}};ColumnChart.prototype=Object.create(BaseChart.prototype),ColumnChart.prototype.constructor=ColumnChart;var MultipleChart=function(a,b,c,d,e){BaseChart.call(this,a,b,c,d),this._chartGroup=e;var f=this;this.x=d3.scale.linear(),this.y=d3.scale.ordinal(),this.yAxis=d3.svg.axis().scale(this.y).orient("left").tickSize(f.tickSize()).tickPadding(10),this.xAxis=d3.svg.axis().scale(this.x).orient("bottom").tickSize(f.tickSize()).tickPadding(10).tickFormat(function(a){return f.xFormatFunc(a)}),this.initializeAxes=function(){this.x.domain([0,this.findMax()]).range([0,this.xBounds().end]),this.y.domain(this.keys()).rangeRoundBands([0,this.yDomain()],.2)},this.rowWidth=function(a){return this.x(this._valueAccessor(a))}.bind(this),this.yPosition=function(a){return this.y(a.key)}.bind(this),this.rowHeight=function(){return this.y.rangeBand()}.bind(this),this.barXPosition=function(a){var b=0;return this.invert()&&(b=this.xBounds().end-this.x(this._valueAccessor(a))),b}.bind(this),this.subChartName=function(a){return"sub"+f._name.replace(/ /g,"_")+a.replace(/\s/g,"")},this.createChart=function(){return this.chart=d3.select(this.element).append("div").attr("class","chart multiChart"),this.chart.append("div").attr("class","title").text(this._displayName),this.chart},this.subCharts=[],this.init=function(){this.createChart();var a=this.chart.selectAll("div.subchart").data(this.dataset());a.enter().append("div").attr("class","subchart").attr("id",function(a){return f.subChartName(f._keyAccessor(a))}),this.dataset().forEach(function(a){var b=[],c=f.dimension.Dimension.group().reduceCount().all().map(f._keyAccessor);c.forEach(function(c){var d={key:c},e=$.grep(a.values,function(a){return a.key==c}),g=e.length?f._valueAccessor(e[0]):0;d.values=g,b.push(d)});var d=new SimpleGroup(b),e="#"+f.subChartName(a.key),g=new RowChart(a.key,e,f.dimension,d,f._chartGroup).width(300).height(300).tooltipLabel(f._tooltipLabel).tooltipFormat(f._tooltipFormat).ordered(f._orderChildren).valueAccessor(function(a){return a.values}).margin({left:120,top:0,bottom:0,right:0});f.subCharts.push(g),f._chartGroup.addChart(g),g.init()})},this.draw=function(){var a=(this.chart.selectAll("div.subchart").data(this.dataset()),this.dataset());this.subCharts.forEach(function(b){var c=$.grep(a,function(a){return a.key==b.displayName()});c=c.length?b._valueAccessor(c[0]):[],b.group.getData().forEach(function(a){var b=$.grep(c,function(b){return b.key==a.key})[0];a.values=b?b.values:0})})}};MultipleChart.prototype=Object.create(BaseChart.prototype),MultipleChart.prototype.constructor=MultipleChart;var RowChart=function(a,b,c,d){BaseChart.call(this,a,b,c,d);var e=this;return this.x=d3.scale.linear(),this.y=d3.scale.ordinal(),this.initializeAxes=function(){this.yAxis=d3.svg.axis().scale(this.y).orient(e.yOrientation()).tickSize(e.tickSize()).tickPadding(e.tickPadding()).tickFormat(e.yAxisFormat()),this.xAxis=d3.svg.axis().scale(this.x).orient(e.xOrientation()).tickSize(e.tickSize()).tickPadding(e.tickPadding()).tickFormat(e.xAxisFormat()),this.x.domain([0,this.findMax()]).range([0,this.xBounds().end]),this.y.domain(this.keys()).rangeRoundBands([this.yBounds().start,this.yBounds().end],e.barPadding())},this.rowWidth=function(a){return this.x(this._valueAccessor(a))}.bind(this),this.yPosition=function(a){return this.y(a.key)}.bind(this),this.rowHeight=function(){return this.y.rangeBand()}.bind(this),this.barXPosition=function(a){var b=0;return this.invert()&&(b=this.xBounds().end-this.x(this._valueAccessor(a))),b}.bind(this),this.init=function(){var a=this;this.createChart(),this.initializeAxes(),this.chart.append("g").attr("class",InsightConstants.YAxisClass).call(this.yAxis).selectAll("text").attr("class",InsightConstants.AxisTextClass).on("mouseover",this.setHover).on("mouseout",this.removeHover).on("click",function(b){a.filterClick(this,b)}),this.draw()},this.draw=function(){var a=this;this.y.domain(this.keys()).rangeRoundBands([0,this.height()],a.barPadding());var b=this.invert()?this.width()-this.margin().right:0;this.chart.selectAll("g."+InsightConstants.YAxisClass).attr("transform","translate("+b+",0)").call(this.yAxis).selectAll("text").each(function(){d3.select(this).classed(InsightConstants.AxisTextClass,"true")}).on("mouseover",this.setHover).on("mouseout",this.removeHover).on("click",function(b){a.filterClick(this,b)}),a._redrawAxes&&this.x.domain([0,this.findMax()]).range([0,this.xBounds().end]);var c=this.chart.selectAll("rect").data(this.dataset(),this.matcher);c.exit().remove();var d=c.enter().append("rect").attr("x",0).attr("y",this.yPosition).attr("width",0).attr("fill",this.barColor()).attr("height",this.rowHeight).on("mouseover",function(b){a.mouseOver(a,this,b)}).on("mouseout",function(b){a.mouseOut(a,this,b)});d.append("svg:text").attr("class","tipValue"),d.append("svg:text").attr("class","tipLabel");var e=c.transition().duration(this.animationDuration);e.attr("x",this.barXPosition).attr("width",this.rowWidth),c.selectAll("text.tipValue").text(this.tooltipText),c.selectAll("text.tipLabel").text(this.tooltipLabel()),(a._redrawAxes||a.orderable())&&e.attr("y",this.yPosition).attr("height",this.rowHeight)},this};RowChart.prototype=Object.create(BaseChart.prototype),RowChart.prototype.constructor=RowChart,PartitionChart.prototype=Object.create(BaseChart.prototype),PartitionChart.prototype.constructor=PartitionChart;